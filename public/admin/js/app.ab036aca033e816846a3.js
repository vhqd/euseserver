webpackJsonp([1],{"+cgv":function(e,t){},"+nw7":function(e,t){},"/Md+":function(e,t){},"0G0D":function(e,t){},"3f40":function(e,t){},"4qOc":function(e,t){},DdXv:function(e,t){},EPYT:function(e,t){},Fylk:function(e,t){},"Mk+s":function(e,t){},N8z9:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("//Fk"),r=n.n(a),i=n("7+uW"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=n("VU/8")({name:"App"},s,!1,function(e){n("Fylk")},"data-v-85ff6454",null).exports,l=n("/ocq"),c=n("NYxO");i.default.use(c.a);var u=new c.a.Store({state:{allCategory:[],firstCategory:[],secCategory:[],tabs:localStorage.getItem("tabs")?JSON.parse(localStorage.getItem("tabs")):[],user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},token:localStorage.getItem("token")?localStorage.getItem("token"):null},mutations:{setUser:function(e,t){e.user=t},setToken:function(e,t){e.token=t},setTabs:function(e,t){e.tabs=t},setAllCategory:function(e,t){e.allCategory=t},setSecCategory:function(e,t){e.secCategory=t},firstCategory:function(e,t){e.firstCategory=t}},getters:{getUser:function(e){return e.user},getToken:function(e){return e.token},getTabs:function(e){return e.tabs},getAllCategory:function(e){return e.allCategory},getSecCategory:function(e){return e.secCategory},getFirstCategory:function(e){return e.firstCategory}},actions:{}}),d={data:function(){return{}},methods:{},computed:{usernmae:function(){return u.getters.getUser.username}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[a("img",{staticStyle:{float:"left",height:"45px","padding-top":"5px"},attrs:{src:n("Z2Ou"),alt:""}}),e._v(" "),a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",[e._v("用户信息")]),e._v(" "),a("el-dropdown-item",[e._v("退出登录")])],1)],1),e._v(" "),a("span",[e._v("欢迎"+e._s(e.usernmae))])],1)],1)},staticRenderFns:[]};var g=n("VU/8")(d,m,!1,function(e){n("q0aT")},"data-v-aadfbd70",null).exports,p=n("mvHQ"),h=n.n(p),f=n("mtWM"),v=n.n(f),b="http://127.0.0.1:3000",y=function(e){return v.a.post(b+"/api/user/login",e)},_=function(e){return v.a.post(b+"/api/user/adduser",e)},C=function(e){return v.a.post(b+"/api/user/edituser",e)},F=function(){return v.a.get(b+"/api/user/users")},w=function(e){return v.a.post(b+"/api/user/deleteuser",e)},S=function(){return v.a.get(b+"/api/category/category")},k=function(e){return v.a.post(b+"/api/category/addcategory",e)},x=function(e){return v.a.post(b+"/api/category/deletecategory",e)},$=function(e){return v.a.post(b+"/api/category/editcategory",e)},z=function(e){return v.a.post(b+"/api/article/addarticle",e)},E=function(e){return v.a.post(b+"/api/article/editarticle",e)},I=function(e){return v.a.post(b+"/api/article/deletearticle",e)},T=function(e){return v.a.post(b+"/api/article/articles",e)},D=function(){return v.a.get(b+"/api/category/getcateall")},V=function(e,t){var n=new Date(e),a=new Date;a.setTime(n.getTime());var r=a.getFullYear(),i=a.getMonth()+1;i=i<10?"0"+i:i,n=(n=a.getDate())<10?"0"+n:n;var s=a.getHours();s=s<10?"0"+s:s;var o=a.getMinutes(),l=a.getSeconds();return o=o<10?"0"+o:o,l=l<10?"0"+l:l,t?r+"-"+i+"-"+n:r+"-"+i+"-"+n+" "+s+":"+o+":"+l};var q={data:function(){return{activeIndex:"0",cates:[]}},watch:{$route:function(e){if(console.log(e),"/category"==e.path){var t=["栏目管理"];u.commit("setTabs",t),localStorage.setItem("tabs",h()(t))}else if("/articles"==e.path)this.getTabs(u.getters.getAllCategory);else if("/users"==e.path){var n=["用户管理"];u.commit("setTabs",n),localStorage.setItem("tabs",h()(n))}}},methods:{getTabs:function(e){var t=this.$route.query.activeIndex.split("-"),n=[];console.log(t.length),2==t.length?n.push(e[0].categoryname):(n.push(e[t[0]].categoryname),n.push(e[t[0]].children[t[1]].categoryname),n.push(e[t[0]].children[t[1]].children[t[2]].categoryname)),u.commit("setTabs",n),localStorage.setItem("tabs",h()(n))}},mounted:function(){var e=this;this.$route.query&&"{}"!=h()(this.$route.query)?this.activeIndex=this.$route.query.activeIndex:this.activeIndex="0",D().then(function(t){console.log(1111111111111),console.log(t);var n=t.data.data.category;e.cates=function(e){for(var t=0;t<e.length-1;t++)for(var n=0;n<e.length-1-t;n++)if(e[n].sort>e[n+1].sort){var a=e[n];e[n]=e[n+1],e[n+1]=a}return e}(n),u.commit("setAllCategory",n)}).catch(function(e){console.log(e)})}},B={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[n("el-menu",{attrs:{"default-active":e.activeIndex}},[n("router-link",{attrs:{to:"/"}},[n("el-menu-item",{attrs:{index:"0"}},[n("i",{staticClass:"el-icon-s-home"}),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])])],1),e._v(" "),n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-receiving"}),e._v("栏目管理\n        ")]),e._v(" "),n("router-link",{attrs:{to:{path:"/category",query:{activeIndex:"1-1"}}}},[n("el-menu-item",{attrs:{index:"1-1"}},[e._v("栏目列表")])],1)],2),e._v(" "),e._l(e.cates,function(t,a){return n("div",{key:a},[0==t.children.length?n("router-link",{attrs:{to:{path:"/articles",query:{activeIndex:a+"-"+(a+1),id:"allCategroy"}}}},[n("el-menu-item",{attrs:{index:"0-0"}},[n("i",{staticClass:"el-icon-notebook-2"}),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.categoryname))])])],1):e._e()],1)}),e._v(" "),e._l(e.cates,function(t,a){return n("div",{key:"key"+a},[0!=t.children.length?n("div",[t.children?n("el-submenu",{attrs:{index:a+"-"+(a+1)}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-notebook-2"}),e._v(" "),n("span",[e._v(e._s(t.categoryname))])]),e._v(" "),e._l(t.children,function(t,r){return n("div",{key:r},[n("el-submenu",{attrs:{index:a+"-"+a+"-"+(r+1)}},[n("template",{slot:"title"},[e._v(e._s(t.categoryname))]),e._v(" "),e._l(t.children,function(i,s){return n("div",{key:s},[i.children?e._e():n("router-link",{attrs:{to:{path:"/articles",query:{activeIndex:a+"-"+r+"-"+s,id:i._id,pid:t._id}}}},[n("el-menu-item",{attrs:{index:a+"-"+r+"-"+s}},[e._v(e._s(i.categoryname))])],1)],1)})],2)],1)})],2):e._e()],1):e._e()])}),e._v(" "),n("el-submenu",{attrs:{index:"99"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-setting"}),e._v("系统管理\n        ")]),e._v(" "),n("router-link",{attrs:{to:{path:"/users",query:{activeIndex:"4-1"}}}},[n("el-menu-item",{attrs:{index:"99-1"}},[e._v("用户管理")])],1),e._v(" "),n("el-menu-item",{attrs:{index:"99-2"}},[e._v("权限管理")])],2)],2)],1)],1)},staticRenderFns:[]};var U=n("VU/8")(q,B,!1,function(e){n("0G0D")},"data-v-1c02f5dc",null).exports,P=n("Zrlr"),M=n.n(P),O=n("wxAW"),N=n.n(O),A=function(){function e(){M()(this,e),this.weekday=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],this.Date=new Date,this.year=this.Date.getFullYear(),this.month=this.Date.getMonth()+1,this.date=this.Date.getDate(),this.day=this.Date.getDay(),this.hour=this.Date.getHours(),this.minute=this.Date.getMinutes(),this.second=this.Date.getSeconds(),this.month=this.month<10?"0"+this.month:this.month=this.month,this.date=this.date<10?"0"+this.date:this.date=this.date,this.minute=this.minute<10?"0"+this.minute:this.minute=this.minute,this.second=this.second<10?"0"+this.second:this.second=this.second}return N()(e,[{key:"getDate",value:function(){return this.year+"年"+this.month+"月"+this.date+"日 "}},{key:"getTime",value:function(){return this.hour+":"+this.minute+":"+this.second}},{key:"getWeek",value:function(){return this.weekday[this.day]}}]),e}(),L={data:function(){return{dateTime:{currentDate:"",currentTime:"",currentWeek:""}}},created:function(){var e=new A;this.dateTime.currentDate=e.getDate(),this.dateTime.currentTime=e.getTime(),this.dateTime.currentWeek=e.getWeek()}},R={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"today"},[t("h2",{staticClass:"word"},[this._v("今日,")]),this._v(" "),t("p",{staticClass:"times"},[this._v(this._s(this.dateTime.currentDate+" "+this.dateTime.currentWeek)+" 欢迎您回到阿里云控制台。")])])},staticRenderFns:[]};var W=n("VU/8")(L,R,!1,function(e){n("/Md+")},"data-v-9a071612",null).exports,H={name:"HelloWorld",data:function(){return{}},created:function(){},components:{euAside:U,euHeader:g,euMain:W},methods:{}},j={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello"},[t("el-container",[t("el-header",{staticClass:"eu-el-header"},[t("eu-header")],1),this._v(" "),t("el-container",{staticStyle:{"padding-top":"60px"}},[t("el-aside",{staticClass:"eu-el-aside",attrs:{width:"200px"}},[t("eu-aside")],1),this._v(" "),t("el-main",{staticClass:"eu-el-main"},[t("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var J=n("VU/8")(H,j,!1,function(e){n("+nw7")},"data-v-d736aa8c",null).exports,Y=n("mw3O"),G=n.n(Y),Q={components:{},data:function(){return{username:"",password:""}},computed:{},watch:{},methods:{sendLogin:function(){var e=this;if(""!=this.username)if(""!=this.password){var t={username:this.username,password:this.password};y(G.a.stringify(t)).then(function(t){console.log(t),200==t.data.code?(u.commit("setToken",t.data.token),localStorage.setItem("token",t.data.token),localStorage.setItem("user",h()(t.data.user)),u.commit("setUser",t.data.user),e.$router.replace("/"),console.log(t)):-1==t.data.code&&e.$message({type:"info",message:t.data.msg})}).catch(function(e){console.log(e)})}else this.$message({type:"info",message:"请输入密码"});else this.$message({type:"info",message:"请输入用户名"})}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},Z={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loginbox"},[e._m(0),e._v(" "),n("div",{staticClass:"main main_bg1 main_bg2"},[n("div",{staticClass:"k1"},[n("div",{staticClass:"login r"},[e._m(1),e._v(" "),n("ul",{staticClass:"bd",attrs:{id:"bd"}},[n("li",{staticStyle:{display:"block"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"tex",attrs:{type:"text",placeholder:"请输入账号"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"tex tex2",attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),e._m(2),e._v(" "),n("div",{staticClass:"clear"}),e._v(" "),n("input",{staticClass:"but",attrs:{type:"button",value:"登     录"},on:{click:e.sendLogin}}),e._v(" "),n("a",{staticClass:"but register"},[e._v("注      册")])])])])])]),e._v(" "),e._m(3)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"k1"},[t("a",{staticClass:"logo",staticStyle:{float:"left"},attrs:{href:"/"}})])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"hd",attrs:{id:"hd"}},[t("li",{staticClass:"on"},[this._v("EUSE管理系统")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"forgive"},[t("label",{staticClass:"l"},[t("input",{staticClass:"che",attrs:{type:"checkbox",value:"1",name:"remember",id:"remember"}}),this._v("\n                自动登录\n              ")]),this._v(" "),t("a",{staticClass:"a2 r",attrs:{href:""}},[this._v("忘记密码?")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"footer"},[t("p",[this._v("Copyright©2019 EUSE@www.zhangqiangwo@qq.com 版权所有")])])}]};var X=n("VU/8")(Q,Z,!1,function(e){n("EPYT")},"data-v-5a24ea06",null).exports,K={components:{},data:function(){return{}},computed:{tabs:function(){return u.getters.getTabs}},watch:{},methods:{},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},ee={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"navi"},[n("el-breadcrumb",{staticStyle:{padding:"10px"},attrs:{separator:"/"}},[n("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),e._l(e.tabs,function(t,a){return n("el-breadcrumb-item",{key:a},[e._v(e._s(t))])})],2)],1)},staticRenderFns:[]};var te=n("VU/8")(K,ee,!1,function(e){n("DdXv")},"data-v-2edaf090",null).exports,ne={components:{euNavi:te},data:function(){return{loading:!0,categorytitle:"添加栏目",categoryBut:"立即创建",currentPage:1,input:"",isreset:!0,addoredit:!0,page:{pagesizes:[12,25,50,100],pagesize:12,pagetotal:50},formInline:{user:"",parentId:""},dialogFormVisible:!1,ruleForm:{categoryname:"",isparent:!1,parentId:"",desc:""},rules:{categoryname:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}]},multipleSelection:[],categorys:[]}},computed:{nowCategorysData:function(){return this.categorys.slice((this.currentPage-1)*this.page.pagesize,this.currentPage*this.page.pagesize)||[]},allCate:function(){return u.getters.getAllCategory},firstCate:function(){return u.getters.getFirstCategory.slice(1,u.getters.getFirstCategory.length)}},watch:{},methods:{addEdit:function(e){this.dialogFormVisible=!0,this.addEditTitle(e)},handleEdit:function(e,t,n){this.addEditTitle(n),this.dialogFormVisible=!0,this.ruleForm=t,console.log(e,t)},addEditTitle:function(e){"add"==e?(this.resetForm(),this.addoredit=!0,this.isreset=!0,this.categorytitle="添加栏目",this.categoryBut="立即创建"):"edit"==e&&(this.categorytitle="编辑栏目",this.categoryBut="修改编辑",this.isreset=!1,this.addoredit=!1)},formatter:function(e,t){return e.address},onSubmit:function(){console.log("submit!")},handleSizeChange:function(e){this.page.pagesize=e,console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e},handleDelete:function(e,t,n){this.clearBatch(),this.multipleSelection.push(t),console.log(this.multipleSelection),this.deletList(e,n)},deletList:function(e,t){t&&0==this.multipleSelection?this.$message({type:"info",message:"请选择需要删除的数据"}):this.deletOpen(e,t)},deletOpen:function(e,t){var n=this;this.$confirm("此操作将永久删除该栏目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=n.multipleSelection;n.deletcategory(e,t)}).catch(function(){t||n.clearBatch(),n.$message({type:"info",message:"已取消删除"})})},deletcategory:function(e,t){var n=this;x(t).then(function(e){console.log(e);for(var a=n.categorys,r=0;r<t.length;r++)for(var i=t[r]._id,s=0;s<a.length;s++)i==a[s]._id&&n.categorys.splice(s,1);n.$message({type:"success",message:e.data.msg})}).catch(function(e){console.log(e),n.$message.error("失败",e)})},clearBatch:function(){this.multipleSelection.splice(0,this.multipleSelection.length)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),t.$message.error("失败",err),!1;if(console.log(t.ruleForm),t.addoredit){if(t.ruleForm.isparent)t.ruleForm.level=1;else for(var n=t.ruleForm.parentId,a=0;a<t.allCate.length;a++)if(n==t.allCate[a]._id){t.ruleForm.level=t.allCate[a].level+1;break}k(t.ruleForm).then(function(e){t.dialogFormVisible=!1,t.getcategorys(),t.$message({type:"success",message:e.data.msg}),console.log(e.data)}).catch(function(e){console.log(e),t.$message.error("失败",e)})}else console.log("编辑栏目"),$(t.ruleForm).then(function(e){t.dialogFormVisible=!1,t.getcategorys(),t.$message({type:"success",message:e.data.msg}),console.log(e.data)}).catch(function(e){console.log(e)})})},getcategorys:function(){var e=this;this.loading=!0,S().then(function(t){var n=t.data.data.category;n.map(function(e,t){n[t].creatat=V(e.creatat,!1),n[t].parents&&(n[t].parents=JSON.parse(n[t].parents))}),e.categorys=n,e.page.pagetotal=n.length,e.loading=!1}).catch(function(e){console.log(e)})},resetForm:function(){this.ruleForm={categoryname:"",parentId:"",isparent:!1,desc:""}}},created:function(){},mounted:function(){this.getcategorys()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},ae={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"category"},[n("eu-navi"),e._v(" "),n("el-row",{staticClass:"handbt"},[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addEdit("add")}}},[e._v("添加栏目")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deletList(0,!0)}}},[e._v("批量删除")])],1),e._v(" "),n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[n("el-form-item",{attrs:{label:"搜索"}},[n("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.nowCategorysData,"default-sort":{prop:"creatat",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"creatat",label:"日期",sortable:"",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"categoryname",label:"栏目名称",sortable:"",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"parent[0].categoryname",label:"父级栏目",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"desc",label:"栏目描述"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleDelete(t.$index,t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:e.categorytitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"栏目名称",prop:"categoryname"}},[n("el-input",{model:{value:e.ruleForm.categoryname,callback:function(t){e.$set(e.ruleForm,"categoryname",t)},expression:"ruleForm.categoryname"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否一级",prop:"isparent"}},[n("el-switch",{model:{value:e.ruleForm.isparent,callback:function(t){e.$set(e.ruleForm,"isparent",t)},expression:"ruleForm.isparent"}})],1),e._v(" "),e.ruleForm.isparent?e._e():n("el-form-item",{attrs:{label:"父级栏目",prop:"parentId"}},[e.allCate?n("el-select",{attrs:{placeholder:"请选择父级"},model:{value:e.ruleForm.parentId,callback:function(t){e.$set(e.ruleForm,"parentId",t)},expression:"ruleForm.parentId"}},e._l(e.allCate,function(e,t){return n("el-option",{key:t,attrs:{label:e.categoryname,value:e._id}})}),1):e._e()],1),e._v(" "),n("el-form-item",{attrs:{label:"栏目描述",prop:"desc"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(e._s(e.categoryBut))]),e._v(" "),e.isreset?n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]):e._e()],1)],1)],1),e._v(" "),n("el-pagination",{staticStyle:{float:"right","margin-top":"5px"},attrs:{"current-page":e.currentPage,"page-sizes":e.page.pagesizes,"page-size":e.page.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.pagetotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var re=n("VU/8")(ne,ae,!1,function(e){n("Mk+s")},"data-v-164c0aea",null).exports,ie=n("G0J2"),se=n.n(ie),oe=[["bold","italic","underline","strike"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","image"],["clean"]],le={components:{euNavi:te,quillEditor:ie.quillEditor},data:function(){return{loading:!0,content:"",serverUrl:"/manager/common/imgUpload",header:{},editorOption:{placeholder:"",theme:"snow",modules:{toolbar:{container:oe,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}},ruleForm:{name:"",parentId:"",desc:"",content:""},rules:{name:[{required:!0,message:"请输入文章名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]},categorytitle:"添加文章",categoryBut:"立即创建",currentPage:1,input:"",isreset:!0,page:{pagesizes:[12,20,50,100],pagesize:12,pagetotal:100},formInline:{user:"",region:""},dialogFormVisible:!1,multipleSelection:[],articles:[]}},computed:{secCate:function(){return u.getters.getSecCategory}},watch:{$route:function(e,t){this.findcategory()}},methods:{beforeUpload:function(){},addArticle:function(){var e=this;console.log(this.ruleForm),this.isreset?z(this.ruleForm).then(function(t){console.log(t),e.findcategory(),e.$message({type:"success",message:t.data.msg}),e.dialogFormVisible=!1}).catch(function(t){e.$message.error("失败",t),console.log(t)}):E(G.a.stringify(this.ruleForm)).then(function(t){console.log(t),e.findcategory(),e.$message({type:"success",message:t.data.msg}),e.dialogFormVisible=!1}).catch(function(t){e.$message.error("失败",t),console.log(t)})},uploadSuccess:function(e,t){console.log(e);var n=this.$refs.myQuillEditor.quill;if(200==e.code){var a=n.getSelection().index;n.insertEmbed(a,"image",e.url),n.setSelection(a+1)}else this.$message.error("图片插入失败")},uploadError:function(){this.$message.error("图片插入失败")},onEditorChange:function(e){e.editor;var t=e.html;e.text;this.content=t,this.ruleForm.content=t,console.log(this.content)},addEdit:function(e){this.dialogFormVisible=!0,this.addEditTitle(e)},handleEdit:function(e,t,n){this.addEditTitle(n),this.dialogFormVisible=!0,this.ruleForm=t,console.log(e,t)},addEditTitle:function(e){"add"==e?(this.resetForm(),this.isreset=!0,this.categorytitle="添加文章",this.categoryBut="立即创建"):"edit"==e&&(this.categorytitle="编辑文章",this.categoryBut="修改编辑",this.isreset=!1)},resetForm:function(){this.ruleForm={title:"",parentId:"",desc:"",content:""}},formatter:function(e,t){return e.address},onSubmit:function(){console.log("submit!")},handleSizeChange:function(e){this.page.pagesize=e,this.findcategory(),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.currentPage=e,this.findcategory(),console.log("当前页: "+e)},handleDelete:function(e,t,n){this.clearBatch(),this.multipleSelection.push(t),console.log(this.multipleSelection),this.deletList(e,n)},deletList:function(e,t){t&&0==this.multipleSelection?this.$message({type:"info",message:"请选择需要删除的数据"}):this.deletOpen(e,t)},deletOpen:function(e,t){var n=this;this.$confirm("此操作将永久删除该栏目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){I(n.multipleSelection).then(function(e){n.findcategory(),n.$message({type:"success",message:e.data.msg})}).catch(function(e){console.log(e),n.$message.error("错误"+e)})}).catch(function(){t||n.clearBatch(),n.$message({type:"info",message:"已取消删除"})})},clearBatch:function(){this.multipleSelection.splice(0,this.multipleSelection.length)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)},findcategory:function(){var e=this,t=this.$route.query.id;if(t){var n={_id:t,currentPage:this.currentPage,pageSize:this.page.pagesize};this.loading=!0,T(n).then(function(t){console.log(t.data);var n=t.data.data.articles;n.map(function(e,t){n[t].creatat=V(e.creatat,!1)}),e.loading=!1,e.articles=n,e.page.pagetotal=t.data.page.totalPage}).catch(function(t){console.log(t),e.$message.error("失败",t)})}}},created:function(){},mounted:function(){this.findcategory()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},ce={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"category"},[n("eu-navi"),e._v(" "),n("el-row",{staticClass:"handbt"},[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addEdit("add")}}},[e._v("添加文章")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deletList(0,!0)}}},[e._v("批量删除")])],1),e._v(" "),n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[n("el-form-item",{attrs:{label:"搜索"}},[n("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.articles,"default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"creatat",label:"日期",sortable:"",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"title",label:"文章标题",sortable:"",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"desc",label:"文字描述"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"success"}},[e._v("预览")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleDelete(t.$index,t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:e.categorytitle,visible:e.dialogFormVisible,width:"75%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"文章名称",prop:"title"}},[n("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),e.ruleForm.isparent?e._e():n("el-form-item",{attrs:{label:"选择栏目",prop:"parentId"}},[e.secCate?n("el-select",{attrs:{placeholder:"请选择栏目"},model:{value:e.ruleForm.parentId,callback:function(t){e.$set(e.ruleForm,"parentId",t)},expression:"ruleForm.parentId"}},e._l(e.secCate,function(e,t){return n("el-option",{key:t,attrs:{label:e.categoryname,value:e._id}})}),1):e._e()],1),e._v(" "),n("el-form-item",{attrs:{label:"文章简介",prop:"desc"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"文章内容："}},[n("quill-editor",{ref:"myQuillEditor",attrs:{content:e.ruleForm.content,options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}}}),e._v(" "),n("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.serverUrl,name:"img",headers:e.header,"show-file-list":!1,"on-success":e.uploadSuccess,"on-error":e.uploadError,"before-upload":e.beforeUpload}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.addArticle}},[e._v(e._s(e.categorytitle))]),e._v(" "),e.isreset?n("el-button",{on:{click:function(t){return e.resetForm("user")}}},[e._v("重置")]):e._e()],1)],1)],1),e._v(" "),n("el-pagination",{staticStyle:{float:"right","margin-top":"5px"},attrs:{"current-page":e.currentPage,"page-sizes":e.page.pagesizes,"page-size":e.page.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.pagetotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var ue=n("VU/8")(le,ce,!1,function(e){n("cbJS")},"data-v-1c28f068",null).exports,de={components:{euNavi:te},data:function(){return{categorytitle:"添加分类",categoryBut:"立即创建",currentPage:1,input:"",isreset:!0,addoredit:!0,page:{pagesizes:[12,35,50,100],pagesize:12,pagetotal:100},formInline:{user:"",region:""},dialogFormVisible:!1,user:{username:"",password:"",isadmin:!1},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:18,message:"长度在 3 到 18 个字符",trigger:"blur"}]},multipleSelection:[],userlist:[]}},computed:{nowuserData:function(){return this.userlist.slice((this.currentPage-1)*this.page.pagesize,this.currentPage*this.page.pagesize)||[]}},watch:{},methods:{addEdit:function(e){this.dialogFormVisible=!0,this.addEditTitle(e)},handleEdit:function(e,t,n){this.addEditTitle(n),this.dialogFormVisible=!0,t.password="",this.user=t,console.log(e,t)},addEditTitle:function(e){"add"==e?(this.addoredit=!0,this.resetForm(),this.isreset=!0,this.categorytitle="添加用户",this.categoryBut="立即创建"):"edit"==e&&(this.addoredit=!1,this.categorytitle="编辑用户",this.categoryBut="修改用户",this.isreset=!1)},formatter:function(e,t){return e.address},onSubmit:function(){console.log("submit!")},handleSizeChange:function(e){this.page.pagesize=e,console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.currentPage=e,console.log("当前页: "+e)},handleDelete:function(e,t,n){this.clearBatch(),this.multipleSelection.push(t),console.log(this.multipleSelection),this.deletList(e,n)},deletList:function(e,t){t&&0==this.multipleSelection?this.$message({type:"info",message:"请选择需要删除的数据"}):this.deletOpen(e,t)},deletOpen:function(e,t){var n=this,a=!1;this.multipleSelection.forEach(function(e,t){if("admin"==e.username)return n.$message.error("不允许删除管理员账号"),void(a=!0)}),a||this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=n.multipleSelection;n.deleusers(e,t)}).catch(function(){t||n.clearBatch(),n.$message({type:"info",message:"已取消删除"})})},deleusers:function(e,t){var n=this;w(t).then(function(e){console.log(e);for(var a=n.userlist,r=0;r<t.length;r++)for(var i=t[r]._id,s=0;s<a.length;s++)i==a[s]._id&&n.userlist.splice(s,1);n.$message({type:"success",message:"删除成功!"})}).catch(function(e){console.log(e),n.$message.error("失败",e)})},clearBatch:function(){this.multipleSelection.splice(0,this.multipleSelection.length)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),t.$message.error("失败",err),!1;t.user.isadmin||(t.user.isadmin=!1);var n={username:t.user.username,password:t.user.password,isadmin:t.user.isadmin};t.addoredit?_(n).then(function(e){200==e.data.code?(t.$message({type:"success",message:e.data.msg}),t.dialogFormVisible=!1,t.getusers()):t.$message.error("添加用户失败")}).catch(function(e){console.log(e),t.$message.error("失败",e)}):(t.user.username=n.username,t.user.password=n.password,t.user.isadmin=n.isadmin,console.log(t.user),C(G.a.stringify(t.user)).then(function(e){200==e.data.code?(t.$message({type:"success",message:e.data.msg}),t.dialogFormVisible=!1,t.getusers()):t.$message.error("添加编辑失败")}).catch(function(e){console.log(e),t.$message.error("失败",e)}))})},getusers:function(){var e=this;F().then(function(t){if(200==t.data.code){var n=t.data.data.userlist;n.map(function(e,t){n[t].creatat=V(e.creatat,!1)});e.userlist=n,e.$set(e.page,"pagetotal",e.userlist.length)}}).catch(function(t){e.$message.error("失败",t),console.log(t)})},resetForm:function(){this.user={username:"",password:""}}},created:function(){},mounted:function(){this.getusers()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},me={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"category"},[n("eu-navi"),e._v(" "),n("el-row",{staticClass:"handbt"},[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addEdit("add")}}},[e._v("添加用户")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deletList(0,!0)}}},[e._v("批量删除")])],1),e._v(" "),n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[n("el-form-item",{attrs:{label:"搜索"}},[n("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.nowuserData,"default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"creatat",label:"创建日期",sortable:"",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"username",label:"用户名",sortable:"",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger",disabled:t.row.isadmin},on:{click:function(n){return e.handleDelete(t.$index,t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:e.categorytitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{ref:"user",staticClass:"demo-ruleForm",attrs:{model:e.user,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"用户名",prop:"username"}},[n("el-input",{model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"用名新密码",prop:"password"}},[n("el-input",{attrs:{type:"password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否管理员",prop:"isadmin"}},[n("el-switch",{model:{value:e.user.isadmin,callback:function(t){e.$set(e.user,"isadmin",t)},expression:"user.isadmin"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("user")}}},[e._v(e._s(e.categoryBut))]),e._v(" "),e.isreset?n("el-button",{on:{click:function(t){return e.resetForm("user")}}},[e._v("重置")]):e._e()],1)],1)],1),e._v(" "),n("el-pagination",{staticStyle:{float:"right","margin-top":"5px"},attrs:{"current-page":e.currentPage,"page-sizes":e.page.pagesizes,"page-size":e.page.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.pagetotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var ge=n("VU/8")(de,me,!1,function(e){n("tjiy")},"data-v-430f8342",null).exports;i.default.use(l.a);var pe=new l.a({routes:[{path:"/",component:J,children:[{path:"",name:"home",component:W},{path:"category",name:"category",component:re},{path:"articles",name:"articles",component:ue},{path:"users",name:"users",component:ge}]},{path:"/login",name:"login",component:X}]}),he=n("zL8q"),fe=n.n(he);n("3f40"),n("4qOc"),n("+cgv"),n("tvR6"),n("N8z9");i.default.use(se.a),i.default.use(fe.a),v.a.defaults.headers.common.Authorization=u.state.token,v.a.interceptors.request.use(function(e){return u.state.token&&(e.headers.Authorization="Bearer "+u.state.token),e},function(e){return r.a.reject(e)}),pe.beforeEach(function(e,t,n){localStorage.getItem("token")?n():"/login"==e.path?n():n("/login")}),i.default.filter("getDate",function(e,t){var n=new Date;n.setTime(1e3*e);var a=n.getFullYear(),r=n.getMonth()+1;r=r<10?"0"+r:r;var i=n.getDate();i=i<10?"0"+i:i;var s=n.getHours();s=s<10?"0"+s:s;var o=n.getMinutes(),l=n.getSeconds();return o=o<10?"0"+o:o,l=l<10?"0"+l:l,t?a+"-"+r+"-"+i:a+"-"+r+"-"+i+" "+s+":"+o+":"+l}),i.default.config.productionTip=!1,new i.default({el:"#app",router:pe,Store:u,components:{App:o},template:"<App/>"})},Z2Ou:function(e,t,n){e.exports=n.p+"../../server/public/admin/img/logo.09c76a3.png"},cbJS:function(e,t){},q0aT:function(e,t){},tjiy:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.ab036aca033e816846a3.js.map