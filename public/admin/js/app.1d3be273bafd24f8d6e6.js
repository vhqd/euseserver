webpackJsonp([1],{"+cgv":function(e,t){},"+nw7":function(e,t){},"/Md+":function(e,t){},"0jG4":function(e,t,a){"use strict";var n=a("mtWM"),r=a.n(n),i="http://127.0.0.1:3000";t.a={login:function(e){return r.a.post(i+"/api/user/login",e)},adduser:function(e){return r.a.post(i+"/api/user/adduser",e)},edituser:function(e){return r.a.post(i+"/api/user/edituser",e)},getusers:function(){return r.a.get(i+"/api/user/users")},deleteuser:function(e){return r.a.post(i+"/api/user/deleteuser",e)},getcategorys:function(){return r.a.get(i+"/api/category/category")},addCategory:function(e){return r.a.post(i+"/api/category/addcategory",e)},deletecategory:function(e){return r.a.post(i+"/api/category/deletecategory",e)},editcategory:function(e){return r.a.post(i+"/api/category/editcategory",e)},addarticle:function(e){return r.a.post(i+"/api/article/addarticle",e)},editarticle:function(e){return r.a.post(i+"/api/article/editarticle",e)},deletearticle:function(e){return r.a.post(i+"/api/article/deletearticle",e)},getarticles:function(e){return r.a.post(i+"/api/article/articles",e)}}},"3f40":function(e,t){},"4qOc":function(e,t){},"8ed7":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__service__=__webpack_require__("0jG4"),__WEBPACK_IMPORTED_MODULE_2__untils_base__=__webpack_require__("ECJm"),__WEBPACK_IMPORTED_MODULE_3__store__=__webpack_require__("IcnI");__webpack_exports__.a={data:function(){return{activeIndex:"0",cates:[]}},watch:{$route:function(e){if(console.log(e),"/category"==e.path){var t=["栏目管理"];__WEBPACK_IMPORTED_MODULE_3__store__.a.commit("setTabs",t),localStorage.setItem("tabs",__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(t))}else if("/articles"==e.path)this.getTabs(__WEBPACK_IMPORTED_MODULE_3__store__.a.getters.getFirstCategory);else if("/users"==e.path){var a=["用户管理"];__WEBPACK_IMPORTED_MODULE_3__store__.a.commit("setTabs",a),localStorage.setItem("tabs",__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(a))}}},methods:{getTabs:function(e){var t=this.$route.query.activeIndex.split("-"),a=[];console.log(t.length),2==t.length?a.push(e[0].categoryname):(a.push(e[t[0]].categoryname),a.push(e[t[0]].children[t[1]].categoryname),a.push(e[t[0]].children[t[1]].children[t[2]].categoryname)),__WEBPACK_IMPORTED_MODULE_3__store__.a.commit("setTabs",a),localStorage.setItem("tabs",__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(a))}},mounted:function mounted(){var _this=this;this.$route.query&&"{}"!=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.$route.query)?this.activeIndex=this.$route.query.activeIndex:this.activeIndex="0",__WEBPACK_IMPORTED_MODULE_1__service__.a.getcategorys().then(function(res){var categorys=res.data.data.category;console.log("categorys",categorys);var firstCate=[],secCate=[];categorys.forEach(function(v,k){v.children=eval("("+v.children+")"),v.children&&v.children.forEach(function(nv,nk){nv.children&&(nv.children=eval("("+nv.children+")"))}),v.isparent?firstCate.push(v):secCate.push(v)}),_this.cates=Object(__WEBPACK_IMPORTED_MODULE_2__untils_base__.b)(firstCate),__WEBPACK_IMPORTED_MODULE_3__store__.a.commit("setAllCategory",categorys),__WEBPACK_IMPORTED_MODULE_3__store__.a.commit("firstCategory",firstCate),__WEBPACK_IMPORTED_MODULE_3__store__.a.commit("setSecCategory",secCate),console.log(Object(__WEBPACK_IMPORTED_MODULE_2__untils_base__.b)(firstCate)),console.log("=================================="),console.log(firstCate)}).catch(function(e){console.log(e)})}}},DdXv:function(e,t){},ECJm:function(e,t,a){"use strict";a.d(t,"a",function(){return n}),t.b=function(e){for(var t=0;t<e.length-1;t++)for(var a=0;a<e.length-1-t;a++)if(e[a].sort>e[a+1].sort){var n=e[a];e[a]=e[a+1],e[a+1]=n}return e};var n=function(e,t){var a=new Date(e),n=new Date;n.setTime(a.getTime());var r=n.getFullYear(),i=n.getMonth()+1;i=i<10?"0"+i:i,a=(a=n.getDate())<10?"0"+a:a;var s=n.getHours();s=s<10?"0"+s:s;var o=n.getMinutes(),l=n.getSeconds();return o=o<10?"0"+o:o,l=l<10?"0"+l:l,t?r+"-"+i+"-"+a:r+"-"+i+"-"+a+" "+s+":"+o+":"+l}},EPYT:function(e,t){},Fylk:function(e,t){},IcnI:function(e,t,a){"use strict";var n=a("7+uW"),r=a("NYxO");n.default.use(r.a);var i=new r.a.Store({state:{allCategory:[],firstCategory:[],secCategory:[],tabs:localStorage.getItem("tabs")?JSON.parse(localStorage.getItem("tabs")):[],user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},token:localStorage.getItem("token")?localStorage.getItem("token"):null},mutations:{setUser:function(e,t){e.user=t},setToken:function(e,t){e.token=t},setTabs:function(e,t){e.tabs=t},setAllCategory:function(e,t){e.allCategory=t},setSecCategory:function(e,t){e.secCategory=t},firstCategory:function(e,t){e.firstCategory=t}},getters:{getUser:function(e){return e.user},getToken:function(e){return e.token},getTabs:function(e){return e.tabs},getAllCategory:function(e){return e.allCategory},getSecCategory:function(e){return e.secCategory},getFirstCategory:function(e){return e.firstCategory}},actions:{}});t.a=i},"Mk+s":function(e,t){},N8z9:function(e,t){},NEjF:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("//Fk"),r=a.n(n),i=a("7+uW"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=a("VU/8")({name:"App"},s,!1,function(e){a("Fylk")},"data-v-85ff6454",null).exports,l=a("/ocq"),c=a("IcnI"),u={data:function(){return{}},methods:{},computed:{usernmae:function(){return c.a.getters.getUser.username}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",[e._v("用户信息")]),e._v(" "),a("el-dropdown-item",[e._v("退出登录")])],1)],1),e._v(" "),a("span",[e._v("欢迎"+e._s(e.usernmae))])],1)],1)},staticRenderFns:[]};var m=a("VU/8")(u,d,!1,function(e){a("OwkU")},"data-v-438e1e9c",null).exports,g=a("8ed7"),f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[a("el-menu",{attrs:{"default-active":e.activeIndex}},[a("router-link",{attrs:{to:"/"}},[a("el-menu-item",{attrs:{index:"0"}},[a("i",{staticClass:"el-icon-s-home"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])])],1),e._v(" "),a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-receiving"}),e._v("栏目管理\n        ")]),e._v(" "),a("router-link",{attrs:{to:{path:"/category",query:{activeIndex:"1-1"}}}},[a("el-menu-item",{attrs:{index:"1-1"}},[e._v("栏目列表")])],1)],2),e._v(" "),e._l(e.cates,function(t,n){return a("div",{key:n},[t.children?e._e():a("router-link",{attrs:{to:{path:"/articles",query:{activeIndex:"0-0",id:"allCategroy"}}}},[a("el-menu-item",{attrs:{index:"0-0"}},[a("i",{staticClass:"el-icon-notebook-2"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.categoryname))])])],1)],1)}),e._v(" "),e._l(e.cates,function(t,n){return a("div",{key:"key"+n},[t.children?a("el-submenu",{attrs:{index:n+"-"+(n+1)}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-notebook-2"}),e._v(" "),a("span",[e._v(e._s(t.categoryname))])]),e._v(" "),e._l(t.children,function(t,r){return a("div",{key:r},[a("el-submenu",{attrs:{index:n+"-"+n+"-"+(r+1)}},[a("template",{slot:"title"},[e._v(e._s(t.categoryname))]),e._v(" "),e._l(t.children,function(i,s){return a("div",{key:s},[i.children?e._e():a("router-link",{attrs:{to:{path:"/articles",query:{activeIndex:n+"-"+r+"-"+s,id:t._id}}}},[a("el-menu-item",{attrs:{index:n+"-"+r+"-"+s}},[e._v(e._s(i.categoryname))])],1)],1)})],2)],1)})],2):e._e()],1)}),e._v(" "),a("el-submenu",{attrs:{index:"99"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-setting"}),e._v("系统管理\n        ")]),e._v(" "),a("router-link",{attrs:{to:{path:"/users",query:{activeIndex:"4-1"}}}},[a("el-menu-item",{attrs:{index:"99-1"}},[e._v("用户管理")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"99-2"}},[e._v("权限管理")])],2)],2)],1)],1)},staticRenderFns:[]};var p=function(e){a("NEjF")},h=a("VU/8")(g.a,f,!1,p,"data-v-495a8c8e",null).exports,_=a("Zrlr"),v=a.n(_),b=a("wxAW"),y=a.n(b),C=function(){function e(){v()(this,e),this.weekday=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],this.Date=new Date,this.year=this.Date.getFullYear(),this.month=this.Date.getMonth()+1,this.date=this.Date.getDate(),this.day=this.Date.getDay(),this.hour=this.Date.getHours(),this.minute=this.Date.getMinutes(),this.second=this.Date.getSeconds(),this.month=this.month<10?"0"+this.month:this.month=this.month,this.date=this.date<10?"0"+this.date:this.date=this.date,this.minute=this.minute<10?"0"+this.minute:this.minute=this.minute,this.second=this.second<10?"0"+this.second:this.second=this.second}return y()(e,[{key:"getDate",value:function(){return this.year+"年"+this.month+"月"+this.date+"日 "}},{key:"getTime",value:function(){return this.hour+":"+this.minute+":"+this.second}},{key:"getWeek",value:function(){return this.weekday[this.day]}}]),e}(),E={data:function(){return{dateTime:{currentDate:"",currentTime:"",currentWeek:""}}},created:function(){var e=new C;this.dateTime.currentDate=e.getDate(),this.dateTime.currentTime=e.getTime(),this.dateTime.currentWeek=e.getWeek()}},w={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"today"},[t("h2",{staticClass:"word"},[this._v("今日,")]),this._v(" "),t("p",{staticClass:"times"},[this._v(this._s(this.dateTime.currentDate+" "+this.dateTime.currentWeek)+" 欢迎您回到阿里云控制台。")])])},staticRenderFns:[]};var k=a("VU/8")(E,w,!1,function(e){a("/Md+")},"data-v-9a071612",null).exports,F={name:"HelloWorld",data:function(){return{}},created:function(){},components:{euAside:h,euHeader:m,euMain:k},methods:{}},S={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello"},[t("el-container",[t("el-header",{staticClass:"eu-el-header"},[t("eu-header")],1),this._v(" "),t("el-container",{staticStyle:{"padding-top":"60px"}},[t("el-aside",{staticClass:"eu-el-aside",attrs:{width:"200px"}},[t("eu-aside")],1),this._v(" "),t("el-main",{staticClass:"eu-el-main"},[t("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var x=a("VU/8")(F,S,!1,function(e){a("+nw7")},"data-v-d736aa8c",null).exports,$=a("mvHQ"),D=a.n($),I=a("mw3O"),T=a.n(I),O=a("0jG4"),P={components:{},data:function(){return{username:"",password:""}},computed:{},watch:{},methods:{sendLogin:function(){var e=this;if(""!=this.username)if(""!=this.password){var t={username:this.username,password:this.password};O.a.login(T.a.stringify(t)).then(function(t){console.log(t),200==t.data.code?(c.a.commit("setToken",t.data.token),localStorage.setItem("token",t.data.token),localStorage.setItem("user",D()(t.data.user)),c.a.commit("setUser",t.data.user),e.$router.replace("/"),console.log(t)):-1==t.data.code&&e.$message({type:"info",message:t.data.msg})}).catch(function(e){console.log(e)})}else this.$message({type:"info",message:"请输入密码"});else this.$message({type:"info",message:"请输入用户名"})}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},M={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginbox"},[e._m(0),e._v(" "),a("div",{staticClass:"main main_bg1 main_bg2"},[a("div",{staticClass:"k1"},[a("div",{staticClass:"login r"},[e._m(1),e._v(" "),a("ul",{staticClass:"bd",attrs:{id:"bd"}},[a("li",{staticStyle:{display:"block"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"tex",attrs:{type:"text",placeholder:"请输入账号"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"tex tex2",attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),e._m(2),e._v(" "),a("div",{staticClass:"clear"}),e._v(" "),a("input",{staticClass:"but",attrs:{type:"button",value:"登     录"},on:{click:e.sendLogin}}),e._v(" "),a("a",{staticClass:"but register"},[e._v("注      册")])])])])])]),e._v(" "),e._m(3)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"k1"},[t("a",{staticClass:"logo",staticStyle:{float:"left"},attrs:{href:"/"}})])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"hd",attrs:{id:"hd"}},[t("li",{staticClass:"on"},[this._v("EUSE管理系统")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"forgive"},[t("label",{staticClass:"l"},[t("input",{staticClass:"che",attrs:{type:"checkbox",value:"1",name:"remember",id:"remember"}}),this._v("\n                自动登录\n              ")]),this._v(" "),t("a",{staticClass:"a2 r",attrs:{href:""}},[this._v("忘记密码?")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"footer"},[t("p",[this._v("Copyright©2019 EUSE@www.zhangqiangwo@qq.com 版权所有")])])}]};var z=a("VU/8")(P,M,!1,function(e){a("EPYT")},"data-v-5a24ea06",null).exports,U={components:{},data:function(){return{}},computed:{tabs:function(){return c.a.getters.getTabs}},watch:{},methods:{},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"navi"},[a("el-breadcrumb",{staticStyle:{padding:"10px"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),e._l(e.tabs,function(t,n){return a("el-breadcrumb-item",{key:n},[e._v(e._s(t))])})],2)],1)},staticRenderFns:[]};var q=a("VU/8")(U,B,!1,function(e){a("DdXv")},"data-v-2edaf090",null).exports,A=a("ECJm"),L={components:{euNavi:q},data:function(){return{loading:!0,categorytitle:"添加栏目",categoryBut:"立即创建",currentPage:1,input:"",isreset:!0,addoredit:!0,page:{pagesizes:[12,25,50,100],pagesize:12,pagetotal:50},formInline:{user:"",parentId:""},dialogFormVisible:!1,ruleForm:{categoryname:"",isparent:!1,parentId:"",desc:""},rules:{categoryname:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}]},multipleSelection:[],categorys:[]}},computed:{nowCategorysData:function(){return this.categorys.slice((this.currentPage-1)*this.page.pagesize,this.currentPage*this.page.pagesize)||[]},allCate:function(){return c.a.getters.getAllCategory},firstCate:function(){return c.a.getters.getFirstCategory.slice(1,c.a.getters.getFirstCategory.length)}},watch:{},methods:{addEdit:function(e){this.dialogFormVisible=!0,this.addEditTitle(e)},handleEdit:function(e,t,a){this.addEditTitle(a),this.dialogFormVisible=!0,this.ruleForm=t,console.log(e,t)},addEditTitle:function(e){"add"==e?(this.resetForm(),this.addoredit=!0,this.isreset=!0,this.categorytitle="添加栏目",this.categoryBut="立即创建"):"edit"==e&&(this.categorytitle="编辑栏目",this.categoryBut="修改编辑",this.isreset=!1,this.addoredit=!1)},formatter:function(e,t){return e.address},onSubmit:function(){console.log("submit!")},handleSizeChange:function(e){this.page.pagesize=e,console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentPage=e},handleDelete:function(e,t,a){this.clearBatch(),this.multipleSelection.push(t),console.log(this.multipleSelection),this.deletList(e,a)},deletList:function(e,t){t&&0==this.multipleSelection?this.$message({type:"info",message:"请选择需要删除的数据"}):this.deletOpen(e,t)},deletOpen:function(e,t){var a=this;this.$confirm("此操作将永久删除该栏目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=a.multipleSelection;a.deletcategory(e,t)}).catch(function(){t||a.clearBatch(),a.$message({type:"info",message:"已取消删除"})})},deletcategory:function(e,t){var a=this;O.a.deletecategory(t).then(function(e){console.log(e);for(var n=a.categorys,r=0;r<t.length;r++)for(var i=t[r]._id,s=0;s<n.length;s++)i==n[s]._id&&a.categorys.splice(s,1);a.$message({type:"success",message:e.data.msg})}).catch(function(e){console.log(e),a.$message.error("失败",e)})},clearBatch:function(){this.multipleSelection.splice(0,this.multipleSelection.length)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),t.$message.error("失败",err),!1;console.log(t.ruleForm),t.addoredit?O.a.addCategory(t.ruleForm).then(function(e){t.dialogFormVisible=!1,t.getcategorys(),t.$message({type:"success",message:e.data.msg}),console.log(e.data)}).catch(function(e){console.log(e),t.$message.error("失败",e)}):(console.log("编辑栏目"),O.a.editcategory(t.ruleForm).then(function(e){t.dialogFormVisible=!1,t.getcategorys(),t.$message({type:"success",message:e.data.msg}),console.log(e.data)}).catch(function(e){console.log(e)}))})},getcategorys:function(){var e=this;this.loading=!0,O.a.getcategorys().then(function(t){var a=t.data.data.category;a.map(function(e,t){a[t].creatat=Object(A.a)(e.creatat,!1),a[t].parents&&(a[t].parents=JSON.parse(a[t].parents))}),e.categorys=a,e.page.pagetotal=a.length,e.loading=!1}).catch(function(e){console.log(e)})},resetForm:function(){this.ruleForm={categoryname:"",parentId:"",isparent:!1,desc:""}}},created:function(){},mounted:function(){this.getcategorys()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},R={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"category"},[a("eu-navi"),e._v(" "),a("el-row",{staticClass:"handbt"},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addEdit("add")}}},[e._v("添加栏目")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deletList(0,!0)}}},[e._v("批量删除")])],1),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"搜索"}},[a("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.nowCategorysData,"default-sort":{prop:"creatat",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"creatat",label:"日期",sortable:"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"categoryname",label:"栏目名称",sortable:"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"parent[0].categoryname",label:"父级栏目",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"栏目描述"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.categorytitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"栏目名称",prop:"categoryname"}},[a("el-input",{model:{value:e.ruleForm.categoryname,callback:function(t){e.$set(e.ruleForm,"categoryname",t)},expression:"ruleForm.categoryname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否一级",prop:"isparent"}},[a("el-switch",{model:{value:e.ruleForm.isparent,callback:function(t){e.$set(e.ruleForm,"isparent",t)},expression:"ruleForm.isparent"}})],1),e._v(" "),e.ruleForm.isparent?e._e():a("el-form-item",{attrs:{label:"父级栏目",prop:"parentId"}},[e.allCate?a("el-select",{attrs:{placeholder:"请选择父级"},model:{value:e.ruleForm.parentId,callback:function(t){e.$set(e.ruleForm,"parentId",t)},expression:"ruleForm.parentId"}},e._l(e.allCate,function(e,t){return a("el-option",{key:t,attrs:{label:e.categoryname,value:e._id}})}),1):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"栏目描述",prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(e._s(e.categoryBut))]),e._v(" "),e.isreset?a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]):e._e()],1)],1)],1),e._v(" "),a("el-pagination",{staticStyle:{float:"right","margin-top":"5px"},attrs:{"current-page":e.currentPage,"page-sizes":e.page.pagesizes,"page-size":e.page.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.pagetotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var j=a("VU/8")(L,R,!1,function(e){a("Mk+s")},"data-v-164c0aea",null).exports,V=a("G0J2"),W=a.n(V),K=[["bold","italic","underline","strike"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","image"],["clean"]],N={components:{euNavi:q,quillEditor:V.quillEditor},data:function(){return{loading:!0,content:"",serverUrl:"/manager/common/imgUpload",header:{},editorOption:{placeholder:"",theme:"snow",modules:{toolbar:{container:K,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}},ruleForm:{name:"",parentId:"",desc:"",content:""},rules:{name:[{required:!0,message:"请输入文章名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]},categorytitle:"添加文章",categoryBut:"立即创建",currentPage:1,input:"",isreset:!0,page:{pagesizes:[12,20,50,100],pagesize:12,pagetotal:100},formInline:{user:"",region:""},dialogFormVisible:!1,multipleSelection:[],articles:[]}},computed:{secCate:function(){return c.a.getters.getSecCategory}},watch:{$route:function(e,t){this.findcategory()}},methods:{beforeUpload:function(){},addArticle:function(){var e=this;console.log(this.ruleForm),this.isreset?O.a.addarticle(this.ruleForm).then(function(t){console.log(t),e.findcategory(),e.$message({type:"success",message:t.data.msg}),e.dialogFormVisible=!1}).catch(function(t){e.$message.error("失败",t),console.log(t)}):O.a.editarticle(T.a.stringify(this.ruleForm)).then(function(t){console.log(t),e.findcategory(),e.$message({type:"success",message:t.data.msg}),e.dialogFormVisible=!1}).catch(function(t){e.$message.error("失败",t),console.log(t)})},uploadSuccess:function(e,t){console.log(e);var a=this.$refs.myQuillEditor.quill;if(200==e.code){var n=a.getSelection().index;a.insertEmbed(n,"image",e.url),a.setSelection(n+1)}else this.$message.error("图片插入失败")},uploadError:function(){this.$message.error("图片插入失败")},onEditorChange:function(e){e.editor;var t=e.html;e.text;this.content=t,this.ruleForm.content=t,console.log(this.content)},addEdit:function(e){this.dialogFormVisible=!0,this.addEditTitle(e)},handleEdit:function(e,t,a){this.addEditTitle(a),this.dialogFormVisible=!0,this.ruleForm=t,console.log(e,t)},addEditTitle:function(e){"add"==e?(this.resetForm(),this.isreset=!0,this.categorytitle="添加文章",this.categoryBut="立即创建"):"edit"==e&&(this.categorytitle="编辑文章",this.categoryBut="修改编辑",this.isreset=!1)},resetForm:function(){this.ruleForm={title:"",parentId:"",desc:"",content:""}},formatter:function(e,t){return e.address},onSubmit:function(){console.log("submit!")},handleSizeChange:function(e){this.page.pagesize=e,this.findcategory(),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.currentPage=e,this.findcategory(),console.log("当前页: "+e)},handleDelete:function(e,t,a){this.clearBatch(),this.multipleSelection.push(t),console.log(this.multipleSelection),this.deletList(e,a)},deletList:function(e,t){t&&0==this.multipleSelection?this.$message({type:"info",message:"请选择需要删除的数据"}):this.deletOpen(e,t)},deletOpen:function(e,t){var a=this;this.$confirm("此操作将永久删除该栏目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){O.a.deletearticle(a.multipleSelection).then(function(e){a.findcategory(),a.$message({type:"success",message:e.data.msg})}).catch(function(e){console.log(e),a.$message.error("错误"+e)})}).catch(function(){t||a.clearBatch(),a.$message({type:"info",message:"已取消删除"})})},clearBatch:function(){this.multipleSelection.splice(0,this.multipleSelection.length)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)},findcategory:function(){var e=this,t=this.$route.query.id;if(t){var a={_id:t,currentPage:this.currentPage,pageSize:this.page.pagesize};this.loading=!0,O.a.getarticles(a).then(function(t){console.log(t.data);var a=t.data.data.articles;a.map(function(e,t){a[t].creatat=Object(A.a)(e.creatat,!1)}),e.loading=!1,e.articles=a,e.page.pagetotal=t.data.page.totalPage}).catch(function(t){console.log(t),e.$message.error("失败",t)})}}},created:function(){},mounted:function(){this.findcategory()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},J={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"category"},[a("eu-navi"),e._v(" "),a("el-row",{staticClass:"handbt"},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addEdit("add")}}},[e._v("添加文章")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deletList(0,!0)}}},[e._v("批量删除")])],1),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"搜索"}},[a("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.articles,"default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"creatat",label:"日期",sortable:"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"文章标题",sortable:"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"文字描述"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"success"}},[e._v("预览")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.categorytitle,visible:e.dialogFormVisible,width:"75%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文章名称",prop:"title"}},[a("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),e.ruleForm.isparent?e._e():a("el-form-item",{attrs:{label:"选择栏目",prop:"parentId"}},[e.secCate?a("el-select",{attrs:{placeholder:"请选择栏目"},model:{value:e.ruleForm.parentId,callback:function(t){e.$set(e.ruleForm,"parentId",t)},expression:"ruleForm.parentId"}},e._l(e.secCate,function(e,t){return a("el-option",{key:t,attrs:{label:e.categoryname,value:e._id}})}),1):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"文章简介",prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文章内容："}},[a("quill-editor",{ref:"myQuillEditor",attrs:{content:e.ruleForm.content,options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}}}),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.serverUrl,name:"img",headers:e.header,"show-file-list":!1,"on-success":e.uploadSuccess,"on-error":e.uploadError,"before-upload":e.beforeUpload}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addArticle}},[e._v(e._s(e.categorytitle))]),e._v(" "),e.isreset?a("el-button",{on:{click:function(t){return e.resetForm("user")}}},[e._v("重置")]):e._e()],1)],1)],1),e._v(" "),a("el-pagination",{staticStyle:{float:"right","margin-top":"5px"},attrs:{"current-page":e.currentPage,"page-sizes":e.page.pagesizes,"page-size":e.page.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.pagetotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var H=a("VU/8")(N,J,!1,function(e){a("cbJS")},"data-v-1c28f068",null).exports,Y={components:{euNavi:q},data:function(){return{categorytitle:"添加分类",categoryBut:"立即创建",currentPage:1,input:"",isreset:!0,addoredit:!0,page:{pagesizes:[12,35,50,100],pagesize:12,pagetotal:100},formInline:{user:"",region:""},dialogFormVisible:!1,user:{username:"",password:"",isadmin:!1},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:18,message:"长度在 3 到 18 个字符",trigger:"blur"}]},multipleSelection:[],userlist:[]}},computed:{nowuserData:function(){return this.userlist.slice((this.currentPage-1)*this.page.pagesize,this.currentPage*this.page.pagesize)||[]}},watch:{},methods:{addEdit:function(e){this.dialogFormVisible=!0,this.addEditTitle(e)},handleEdit:function(e,t,a){this.addEditTitle(a),this.dialogFormVisible=!0,t.password="",this.user=t,console.log(e,t)},addEditTitle:function(e){"add"==e?(this.addoredit=!0,this.resetForm(),this.isreset=!0,this.categorytitle="添加用户",this.categoryBut="立即创建"):"edit"==e&&(this.addoredit=!1,this.categorytitle="编辑用户",this.categoryBut="修改用户",this.isreset=!1)},formatter:function(e,t){return e.address},onSubmit:function(){console.log("submit!")},handleSizeChange:function(e){this.page.pagesize=e,console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.currentPage=e,console.log("当前页: "+e)},handleDelete:function(e,t,a){this.clearBatch(),this.multipleSelection.push(t),console.log(this.multipleSelection),this.deletList(e,a)},deletList:function(e,t){t&&0==this.multipleSelection?this.$message({type:"info",message:"请选择需要删除的数据"}):this.deletOpen(e,t)},deletOpen:function(e,t){var a=this,n=!1;this.multipleSelection.forEach(function(e,t){if("admin"==e.username)return a.$message.error("不允许删除管理员账号"),void(n=!0)}),n||this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=a.multipleSelection;a.deleusers(e,t)}).catch(function(){t||a.clearBatch(),a.$message({type:"info",message:"已取消删除"})})},deleusers:function(e,t){var a=this;O.a.deleteuser(t).then(function(e){console.log(e);for(var n=a.userlist,r=0;r<t.length;r++)for(var i=t[r]._id,s=0;s<n.length;s++)i==n[s]._id&&a.userlist.splice(s,1);a.$message({type:"success",message:"删除成功!"})}).catch(function(e){console.log(e),a.$message.error("失败",e)})},clearBatch:function(){this.multipleSelection.splice(0,this.multipleSelection.length)},handleSelectionChange:function(e){this.multipleSelection=e,console.log(this.multipleSelection)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),t.$message.error("失败",err),!1;t.user.isadmin||(t.user.isadmin=!1);var a={username:t.user.username,password:t.user.password,isadmin:t.user.isadmin};t.addoredit?O.a.adduser(a).then(function(e){200==e.data.code?(t.$message({type:"success",message:e.data.msg}),t.dialogFormVisible=!1,t.getusers()):t.$message.error("添加用户失败")}).catch(function(e){console.log(e),t.$message.error("失败",e)}):(t.user.username=a.username,t.user.password=a.password,t.user.isadmin=a.isadmin,console.log(t.user),O.a.edituser(T.a.stringify(t.user)).then(function(e){200==e.data.code?(t.$message({type:"success",message:e.data.msg}),t.dialogFormVisible=!1,t.getusers()):t.$message.error("添加编辑失败")}).catch(function(e){console.log(e),t.$message.error("失败",e)}))})},getusers:function(){var e=this;O.a.getusers().then(function(t){if(200==t.data.code){var a=t.data.data.userlist;a.map(function(e,t){a[t].creatat=Object(A.a)(e.creatat,!1)});e.userlist=a,e.$set(e.page,"pagetotal",e.userlist.length)}}).catch(function(t){e.$message.error("失败",t),console.log(t)})},resetForm:function(){this.user={username:"",password:""}}},created:function(){},mounted:function(){this.getusers()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},G={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"category"},[a("eu-navi"),e._v(" "),a("el-row",{staticClass:"handbt"},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addEdit("add")}}},[e._v("添加用户")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deletList(0,!0)}}},[e._v("批量删除")])],1),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"搜索"}},[a("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.nowuserData,"default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"creatat",label:"创建日期",sortable:"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名",sortable:"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row,"edit")}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",disabled:t.row.isadmin},on:{click:function(a){return e.handleDelete(t.$index,t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.categorytitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"user",staticClass:"demo-ruleForm",attrs:{model:e.user,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用名新密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否管理员",prop:"isadmin"}},[a("el-switch",{model:{value:e.user.isadmin,callback:function(t){e.$set(e.user,"isadmin",t)},expression:"user.isadmin"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("user")}}},[e._v(e._s(e.categoryBut))]),e._v(" "),e.isreset?a("el-button",{on:{click:function(t){return e.resetForm("user")}}},[e._v("重置")]):e._e()],1)],1)],1),e._v(" "),a("el-pagination",{staticStyle:{float:"right","margin-top":"5px"},attrs:{"current-page":e.currentPage,"page-sizes":e.page.pagesizes,"page-size":e.page.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.pagetotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var Q=a("VU/8")(Y,G,!1,function(e){a("tjiy")},"data-v-430f8342",null).exports;i.default.use(l.a);var X=new l.a({routes:[{path:"/",component:x,children:[{path:"",name:"home",component:k},{path:"category",name:"category",component:j},{path:"articles",name:"articles",component:H},{path:"users",name:"users",component:Q}]},{path:"/login",name:"login",component:z}]}),Z=a("zL8q"),ee=a.n(Z),te=a("mtWM"),ae=a.n(te);a("3f40"),a("4qOc"),a("+cgv"),a("tvR6"),a("N8z9");i.default.use(W.a),i.default.use(ee.a),ae.a.defaults.headers.common.Authorization=c.a.state.token,ae.a.interceptors.request.use(function(e){return c.a.state.token&&(e.headers.Authorization="Bearer "+c.a.state.token),e},function(e){return r.a.reject(e)}),X.beforeEach(function(e,t,a){localStorage.getItem("token")?a():"/login"==e.path?a():a("/login")}),i.default.filter("getDate",function(e,t){var a=new Date;a.setTime(1e3*e);var n=a.getFullYear(),r=a.getMonth()+1;r=r<10?"0"+r:r;var i=a.getDate();i=i<10?"0"+i:i;var s=a.getHours();s=s<10?"0"+s:s;var o=a.getMinutes(),l=a.getSeconds();return o=o<10?"0"+o:o,l=l<10?"0"+l:l,t?n+"-"+r+"-"+i:n+"-"+r+"-"+i+" "+s+":"+o+":"+l}),i.default.config.productionTip=!1,new i.default({el:"#app",router:X,Store:c.a,components:{App:o},template:"<App/>"})},OwkU:function(e,t){},cbJS:function(e,t){},tjiy:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.1d3be273bafd24f8d6e6.js.map